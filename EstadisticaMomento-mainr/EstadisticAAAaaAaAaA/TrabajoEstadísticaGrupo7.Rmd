---
title: "TrabajoEstadistica"
author: "Grupo7"
date: "2024-09-24"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```



# Introducción y definición de objetivos

El archivo contiene un analisis de datos sobre la relación entre diversos factores (año de lanzamiento, puntuación, etc) y la satisfacción con videojuegos en Steam.

Con estos archivos de datos se pretende hacer un estudio del mercado de los videojuegos y como las críticas oficiales en la plataforma difieren de la opinión de los jugadores comunes.
También se piensa analizar como el tiempo empleado en superar todo el contenido disponible afecta al recibimiento de los jugadores.
Por último, como el género del juego afecta a la positividad de las reseñas y cual es el género más jugado a lo largo de los años.


# Importación de datos y carga de paquetes

...

```{r}
library(tidyverse)
library(summarytools)
library(GGally)
library(gt)
library(flextable)
library(knitr)
library(corrplot)
library(kableExtra)

```


```{r}
datos <- readxl::read_excel("dataset.xlsx") 

```
              
# Diccionario de datos

* `id`: Identificador del juego
* `name`: Nombre del juego
* `year`: Año de salida al mercado
* `metacritic_rating`: Nota de la valoración profesional  (sobre 100)
* `reviewer_rating`: Nota de la valoración de usuarios   (sobre 10)
* `positivity_ratio`: valoraciones positivas/valoraciones negativas
* `to_beat_main`: Tiempo necesario para superar el juego principal (h)
* `to_beat_extra`: Tiempo necesario para superar el juego principal y contenido extra (h)
* `to_beat_completionist`: Tiempo para completar todos los objetivos (h)
* `extra_content_length`: Diferencia entre tiempo de objetivos y tiempo de contenido extra
* `tags`: Tags/ categorias del juego


# Muestra del dataset
```{r}
datos |>  
  slice_head(n=10) |> 

  gt()
```


# Análisis exploratorio de datos
Comenzamos el EDA (Análisis exploratorio de datos) con la intención de buscar relaciones entre los datos y descubrir patrones , para ello usamos diferentes gráficos y métodos.


## Datos univariantes
...

### Tablas de frecuencias
Vamos a hacer tablas de frecuencias para ver la frecuencia en algunos de los datos de el dataset. Los datos que mediremos en estas tablas seran: el dato 'tag' que da informacion sobre el juego, el dato 'to_beat_main' que da informacion sobre el tiempo en horas que se requiere para terminar la historia principal del juego, el dato 'to_beat_extra' que da informacion sobre el tiempo en horas para completar contenido extra y el dato 'to_beat_completionist' que da informacion del tiempo en horas para completar todos los objetivos del juego

```{r}
# Paso 1: Separar las etiquetas usando strsplit con el delimitador |
tags_separados <- strsplit(datos$tags, "\\|")

# Paso 2: Aplanar la lista resultante en un vector
tags_vector <- unlist(tags_separados)

# Paso 3: Crear una tabla de frecuencias
tabla_frecuencias <- as.data.frame(table(tags_vector))

# Paso 4: Calcular la frecuencia relativa (f), frecuencia acumulada (N) y frecuencia relativa acumulada (F)
tabla_frecuencias <- tabla_frecuencias %>%
  mutate(f = Freq / sum(Freq),         # Frecuencia relativa
         N = cumsum(Freq),             # Frecuencia acumulada
         F = cumsum(f))                # Frecuencia relativa acumulada

# Paso 5: Mostrar la tabla con formato
knitr::kable(tabla_frecuencias, digits = 4)
```

///aqui habría que hacer otra tabla de freciencias creo
```{r}
# Paso 3: Crear una tabla de frecuencias
tabla_frecuencias2 <- as.data.frame(table(datos$to_beat_main))

# Paso 4: Calcular la frecuencia relativa (f), frecuencia acumulada (N) y frecuencia relativa acumulada (F)
tabla_frecuencias2 <- tabla_frecuencias2 %>%
  mutate(f = Freq / sum(Freq),         # Frecuencia relativa
         N = cumsum(Freq),             # Frecuencia acumulada
         F = cumsum(f))                # Frecuencia relativa acumulada

# Paso 5: Mostrar la tabla con formato
knitr::kable(tabla_frecuencias2, digits = 4)
```
```{r}
# Paso 3: Crear una tabla de frecuencias
tabla_frecuencias3 <- as.data.frame(table(datos$to_beat_extra))

# Paso 4: Calcular la frecuencia relativa (f), frecuencia acumulada (N) y frecuencia relativa acumulada (F)
tabla_frecuencias3 <- tabla_frecuencias3 %>%
  mutate(f = Freq / sum(Freq),         # Frecuencia relativa
         N = cumsum(Freq),             # Frecuencia acumulada
         F = cumsum(f))                # Frecuencia relativa acumulada

# Paso 5: Mostrar la tabla con formato
knitr::kable(tabla_frecuencias3, digits = 4)
```
```{r}
# Paso 3: Crear una tabla de frecuencias
tabla_frecuencias4 <- as.data.frame(table(datos$to_beat_completionist))

# Paso 4: Calcular la frecuencia relativa (f), frecuencia acumulada (N) y frecuencia relativa acumulada (F)
tabla_frecuencias4 <- tabla_frecuencias4 %>%
  mutate(f = Freq / sum(Freq),         # Frecuencia relativa
         N = cumsum(Freq),             # Frecuencia acumulada
         F = cumsum(f))                # Frecuencia relativa acumulada

# Paso 5: Mostrar la tabla con formato
knitr::kable(tabla_frecuencias4, digits = 4)
```
### Gráficos de barras
//he hecho un gráfico de las puntuaciones de los jugadores

A continuacion se realizaran los graficos para mayor compresion de los datos. Se realiaran graficos de los datos referentes a puntuaciones de los juego, o sea: 'metacritic_rating', 'reviewer_rating',...

```{r}
datos |> 
  # Inicia una visualización de ggplot con 'lab' como el dataframe y 'tipo' como variable en el eje x.
  ggplot(aes(x = year)) +
  # Añade un gráfico de barras, rellenando las barras con el color #CB0017.
  geom_bar(fill = "skyblue") +
  # Aplica un tema predeterminado en blanco y negro para la visualización.
  theme_bw() + 
  # Establece los títulos del gráfico, eje x, y eje y.
  labs(title = "Juegos por año", 
       x = "Año de salida (2005-2023)",
       y = "Cantidad de juegos")
      
```



```{r}
datos |> 
  # Inicia una visualización de ggplot con 'lab' como el dataframe y 'tipo' como variable en el eje x.
  ggplot(aes(x = metacritic_rating)) +
  # Añade un gráfico de barras, rellenando las barras con el color #CB0017.
  geom_bar(fill = "skyblue") +
  # Aplica un tema predeterminado en blanco y negro para la visualización.
  theme_bw() + 
  # Establece los títulos del gráfico, eje x, y eje y.
  labs(title = "Puntuación del crítico", 
       x = "Puntuación (0-100)",
       y = "Frecuencia absoluta")
      
```

```{r}
datos |> 
  # Inicia una visualización de ggplot con 'lab' como el dataframe y 'tipo' como variable en el eje x.
  ggplot(aes(x = reviewer_rating)) +
  # Añade un gráfico de barras, rellenando las barras con el color #CB0017.
   geom_bar(fill = "skyblue") +
  # Aplica un tema predeterminado en blanco y negro para la visualización.
  theme_bw() + 
  # Establece los títulos del gráfico, eje x, y eje y.
  labs(title = "Puntuación del jugador", 
       x = "Puntuación (0-10)",
       y = "Frecuencia absoluta")
```

```{r}
datos |> 
  # Inicia una visualización de ggplot con 'lab' como el dataframe y 'tipo' como variable en el eje x.
  ggplot(aes(x = positivity_ratio)) +
  # Añade un gráfico de barras, rellenando las barras con el color #CB0017.
   geom_histogram(fill = "skyblue") +
  # Aplica un tema predeterminado en blanco y negro para la visualización.
  theme_bw() + 
  # Establece los títulos del gráfico, eje x, y eje y.
  labs(title = "Puntuación del jugador", 
       x = "Puntuación (0-10)",
       y = "Frecuencia absoluta")
```
```{r}

ratio_freq <- dataset %>%
  group_by(positivity_ratio) %>%
  summarise(Frequency = n()) %>%
  mutate(Frequency = Frequency/ sum(Frequency)) %>%
  slice_max(Frequency, n=25) %>%
  mutate(positivity_ratio = reorder(positivity_ratio, -Frequency))

 ggplot(ratio_freq, aes(x = positivity_ratio, y = Frequency)) +
  # Añade un gráfico de barras, rellenando las barras con el color #CB0017.
   geom_bar(stat = "identity", aes(fill = Frequency)) +
   scale_y_continuous(labels = scales::percent) +
  # Aplica un tema predeterminado en blanco y negro para la visualización.
  theme_bw() + 
  # Establece los títulos del gráfico, eje x, y eje y.
  labs(title = "Frequencia de tags", 
       x = "Tags",
       y = "Frecuencia ") + 
   scale_fill_gradient("Frecuencia", low = "skyblue", high = "coral2") +
   theme(axis.text.x = element_text(angle = 90, hjust = 1))
```


```{r}
tags_df <- data.frame(tags = unlist(tags_separados))
tags_df |> group_by(tags) |>  summarise(Frequency = n()) |> mutate(Frequency = Frequency/sum(Frequency), tags = reorder(tags, -Frequency)) |> ggplot(aes(x = tags, y = Frequency)) + geom_bar(stat = "identity", aes(fill = Frequency)) + scale_y_continuous(labels = scales::percent) + theme_bw() + labs(title = "Gráfico de barras con frecuencia relativa de diferentes tags", x = "Tags", y = "Frecuencia relativa") + scale_fill_gradient("Frecuencia", low = "skyblue", high = "coral2") + theme(axis.text.x = element_text(angle = 45, hjust = 1))
```



```{r}
tags_df <- data.frame(tags = unlist(tags_separados))

tags_freq <-tags_df %>%
  group_by(tags) %>%
  summarise(Frequency = n()) %>%
  mutate(Frequency = Frequency/ sum(Frequency)) %>%
  slice_max(Frequency, n=25) %>%
  mutate(tags = reorder(tags, -Frequency))

 ggplot(tags_freq, aes(x = tags, y = Frequency)) +
  # Añade un gráfico de barras, rellenando las barras con el color #CB0017.
   geom_bar(stat = "identity", aes(fill = Frequency)) +
   scale_y_continuous(labels = scales::percent) +
  # Aplica un tema predeterminado en blanco y negro para la visualización.
  theme_bw() + 
  # Establece los títulos del gráfico, eje x, y eje y.
  labs(title = "Frequencia de tags", 
       x = "Tags",
       y = "Frecuencia ") + 
   scale_fill_gradient("Frecuencia", low = "skyblue", high = "coral2") +
   theme(axis.text.x = element_text(angle = 90, hjust = 1))
```

```{r}
tags_df <- data.frame(tags = unlist(tags_separados))

tags_freq <-tags_df %>%
  group_by(tags) %>%
  summarise(Frequency = n()) %>%
  mutate(Frequency = Frequency/ sum(Frequency)) %>%
  slice_min(Frequency, n=25) %>%
  mutate(tags = reorder(tags, -Frequency))

 ggplot(tags_freq, aes(x = tags, y = Frequency)) +
  # Añade un gráfico de barras, rellenando las barras con el color #CB0017.
   geom_bar(stat = "identity", aes(fill = Frequency)) +
   scale_y_continuous(labels = scales::percent) +
  # Aplica un tema predeterminado en blanco y negro para la visualización.
  theme_bw() + 
  # Establece los títulos del gráfico, eje x, y eje y.
  labs(title = "Frequencia de tags", 
       x = "Tags",
       y = "Frecuencia ") + 
   scale_fill_gradient("Frecuencia", low = "lightblue", high = "coral2") +
   theme(axis.text.x = element_text(angle = 90, hjust = 1))
```



```{r}
datos |> 
  # Inicia una visualización de ggplot con 'lab' como el dataframe y 'tipo' como variable en el eje x.
  ggplot(aes(x = to_beat_main)) +
  # Añade un gráfico de barras, rellenando las barras con el color #CB0017.
   geom_histogram(fill = "skyblue") +
  # Aplica un tema predeterminado en blanco y negro para la visualización.
  theme_bw() + 
  # Establece los títulos del gráfico, eje x, y eje y.
  labs(title = "Tiempo en completar el juego principal", 
       x = "Tiempo",
       y = "Frecuencia absoluta")
```

s


