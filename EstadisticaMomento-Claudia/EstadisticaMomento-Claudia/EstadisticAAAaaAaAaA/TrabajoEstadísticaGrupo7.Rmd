---
title: "TrabajoEstadistica"
author: "Grupo7"
date: "2024-09-24"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```



# Introducción y definición de objetivos
Mediante el estudio estadístico de datos obtenidos sobre los juegos publicados en la plataforma de Steam desde 2005, se pretende conocer y analizar si es posible establecer alguna relación entre las diversas variables que se toman en cuenta en dicho estudio (año de lanzamiento, puntuación media de usarios, etc.).

Al disponer de variables enlazadas directamente a la acogida por parte del público de los diversos títulos de Steam, el principal próposito de esta investigación es llevar a cabo un estudio de mercado sobre los mismos. De este modo se analizaría si es posible establecer una conexión directa entre la satisfacción del púbico y otras variables como podrían ser la duración o los tags. Esta última podría resultar sumamente interesante puesto que sería posible explorar las tendencias de los usuarios a la hora de puntuar juegos de determinados géneros o categorías, profundizando así más allá de los aspectos técnicos del videojuego (como el tiempo de contenido), en lo que el usuario busca experimentar sensorial, emocional o psicológicamente a la hora de decidir qué jugar. Asimismo, dado que las valoraciones profesionales no tienen por qué coincidir con las de los usuarios, también sería de interés estudiar cómo difieren entre sí.

Por otro lado, también se pretende llevar a cabo un análisis sobre los propios desarrolladores, descubriendo así cuáles son los géneros que tienen más lanzamientos cada año y si es posible establecer una relación con las valoraciones de lanzamientos del mismo género de años anteriores.


// Texto antiguo por si queréis verlo, luego lo borramos
El archivo contiene un analisis de datos sobre la relación entre diversos factores (año de lanzamiento, puntuación, etc) y la satisfacción con videojuegos en Steam.

Con estos archivos de datos se pretende hacer un estudio del mercado de los videojuegos y como las críticas oficiales en la plataforma difieren de la opinión de los jugadores comunes.
También se piensa analizar como el tiempo empleado en superar todo el contenido disponible afecta al recibimiento de los jugadores.
Por último, como el género del juego afecta a la positividad de las reseñas y cual es el género más jugado a lo largo de los años.


# Importación de datos y carga de paquetes

...

```{r}
library(tidyverse)
library(summarytools)
library(GGally)
library(gt)
library(flextable)
library(knitr)
library(corrplot)
library(kableExtra)
library(ggplot2)
library(tidyr)
library(dplyr)

```


```{r}
datos <- readxl::read_excel("dataset.xlsx") 

```
              
# Diccionario de datos

* `id`: Identificador del juego (identificador)
* `name`: Nombre del juego (identificador)
* `year`: Año de salida al mercado (numérica discreta)
* `metacritic_rating`: Nota media de valoración profesional (numérica discreta, valor sobre 100)
* `reviewer_rating`: Nota media de la valoración de los usuarios   (numérica discreta, sobre 10)
* `positivity_ratio`: Ratio de positividad, cociente entrev las Valoraciones positivas y las valoraciones negativas (numérica continua)
* `to_beat_main`: Tiempo medio necesario para superar el juego principal (numérica continua, medida en horas)
* `to_beat_extra`: Tiempo medio necesario para superar el juego principal y contenido extra (numérica continua, medida en horas)
* `to_beat_completionist`: Tiempo medio para completar todo el contenido del juego y obtener todo sus logros (numérica continua, medida en horas)
* `extra_content_length`: Diferencia de tiempo entre el contenido principal y el extra (numérica continua, medida en horas)
* `tags`: Categorías o "tags" bajo las que se encuentra inscrito cada juego (categórica multinivel)


# Muestra del dataset
```{r}
datos |>  
  slice_head(n=10) |> 

  gt()
```


# Análisis exploratorio de datos
Comenzamos el EDA (Análisis exploratorio de datos) con la intención de buscar relaciones entre los datos y descubrir patrones , para ello usamos diferentes gráficos y métodos.


## Datos univariantes
...

### Tablas de frecuencias
Vamos a hacer tablas de frecuencias para ver la frecuencia en algunos de los datos de el dataset. Los datos que mediremos en estas tablas seran: el dato 'tag' que da informacion sobre el juego, el dato 'to_beat_main' que da informacion sobre el tiempo en horas que se requiere para terminar la historia principal del juego, el dato 'to_beat_extra' que da informacion sobre el tiempo en horas para completar contenido extra y el dato 'to_beat_completionist' que da informacion del tiempo en horas para completar todos los objetivos del juego

```{r}
# Paso 1: Separar las etiquetas usando strsplit con el delimitador |
tags_separados <- strsplit(datos$tags, "\\|")

# Paso 2: Aplanar la lista resultante en un vector
tags_vector <- unlist(tags_separados)

# Paso 3: Crear una tabla de frecuencias
tabla_frecuencias <- as.data.frame(table(tags_vector))

# Paso 4: Calcular la frecuencia relativa (f), frecuencia acumulada (N) y frecuencia relativa acumulada (F)
tabla_frecuencias <- tabla_frecuencias %>%
  mutate(f = Freq / sum(Freq),         # Frecuencia relativa
         N = cumsum(Freq),             # Frecuencia acumulada
         F = cumsum(f))                # Frecuencia relativa acumulada

# Paso 5: Mostrar la tabla con formato
knitr::kable(tabla_frecuencias, digits = 4)
```

///aqui habría que hacer otra tabla de freciencias creo
```{r}
# Paso 3: Crear una tabla de frecuencias
tabla_frecuencias2 <- as.data.frame(table(datos$to_beat_main))

# Paso 4: Calcular la frecuencia relativa (f), frecuencia acumulada (N) y frecuencia relativa acumulada (F)
tabla_frecuencias2 <- tabla_frecuencias2 %>%
  mutate(f = Freq / sum(Freq),         # Frecuencia relativa
         N = cumsum(Freq),             # Frecuencia acumulada
         F = cumsum(f))                # Frecuencia relativa acumulada

# Paso 5: Mostrar la tabla con formato
knitr::kable(tabla_frecuencias2, digits = 4)
```
```{r}
# Paso 3: Crear una tabla de frecuencias
tabla_frecuencias3 <- as.data.frame(table(datos$to_beat_extra))

# Paso 4: Calcular la frecuencia relativa (f), frecuencia acumulada (N) y frecuencia relativa acumulada (F)
tabla_frecuencias3 <- tabla_frecuencias3 %>%
  mutate(f = Freq / sum(Freq),         # Frecuencia relativa
         N = cumsum(Freq),             # Frecuencia acumulada
         F = cumsum(f))                # Frecuencia relativa acumulada

# Paso 5: Mostrar la tabla con formato
knitr::kable(tabla_frecuencias3, digits = 4)
```
```{r}
# Paso 3: Crear una tabla de frecuencias
tabla_frecuencias4 <- as.data.frame(table(datos$to_beat_completionist))

# Paso 4: Calcular la frecuencia relativa (f), frecuencia acumulada (N) y frecuencia relativa acumulada (F)
tabla_frecuencias4 <- tabla_frecuencias4 %>%
  mutate(f = Freq / sum(Freq),         # Frecuencia relativa
         N = cumsum(Freq),             # Frecuencia acumulada
         F = cumsum(f))                # Frecuencia relativa acumulada

# Paso 5: Mostrar la tabla con formato
knitr::kable(tabla_frecuencias4, digits = 4)
```
### Gráficos de barras
//he hecho un gráfico de las puntuaciones de los jugadores

A continuacion se realizaran los graficos para mayor compresion de los datos. Se realiaran graficos de los datos referentes a puntuaciones de los juego, o sea: 'metacritic_rating', 'reviewer_rating',...

```{r}
datos |> 
  # Inicia una visualización de ggplot con 'lab' como el dataframe y 'tipo' como variable en el eje x.
  ggplot(aes(x = year)) +
  # Añade un gráfico de barras, rellenando las barras con el color #CB0017.
  geom_bar(fill = "skyblue") +
  # Aplica un tema predeterminado en blanco y negro para la visualización.
  theme_bw() + 
  # Establece los títulos del gráfico, eje x, y eje y.
  labs(title = "Juegos por año", 
       x = "Año de salida (2005-2023)",
       y = "Cantidad de juegos")
      
```



```{r}
datos |> 
  # Inicia una visualización de ggplot con 'lab' como el dataframe y 'tipo' como variable en el eje x.
  ggplot(aes(x = metacritic_rating)) +
  # Añade un gráfico de barras, rellenando las barras con el color #CB0017.
  geom_bar(fill = "skyblue") +
  # Aplica un tema predeterminado en blanco y negro para la visualización.
  theme_bw() + 
  # Establece los títulos del gráfico, eje x, y eje y.
  labs(title = "Puntuación del crítico", 
       x = "Puntuación (0-100)",
       y = "Frecuencia absoluta")
      
```

```{r}
datos |> 
  # Inicia una visualización de ggplot con 'lab' como el dataframe y 'tipo' como variable en el eje x.
  ggplot(aes(x = reviewer_rating)) +
  # Añade un gráfico de barras, rellenando las barras con el color #CB0017.
   geom_bar(fill = "skyblue") +
  # Aplica un tema predeterminado en blanco y negro para la visualización.
  theme_bw() + 
  # Establece los títulos del gráfico, eje x, y eje y.
  labs(title = "Puntuación del jugador", 
       x = "Puntuación (0-10)",
       y = "Frecuencia absoluta")
```

```{r}
datos |> 
  # Inicia una visualización de ggplot con 'lab' como el dataframe y 'tipo' como variable en el eje x.
  ggplot(aes(x = positivity_ratio)) +
  # Añade un gráfico de barras, rellenando las barras con el color #CB0017.
   geom_histogram(fill = "skyblue") +
  # Aplica un tema predeterminado en blanco y negro para la visualización.
  theme_bw() + 
  # Establece los títulos del gráfico, eje x, y eje y.
  labs(title = "Puntuación del jugador", 
       x = "Puntuación (0-10)",
       y = "Frecuencia absoluta")
```
```{r}

ratio_freq <- dataset %>%
  group_by(positivity_ratio) %>%
  summarise(Frequency = n()) %>%
  mutate(Frequency = Frequency/ sum(Frequency)) %>%
  slice_max(Frequency, n=25) %>%
  mutate(positivity_ratio = reorder(positivity_ratio, -Frequency))

 ggplot(ratio_freq, aes(x = positivity_ratio, y = Frequency)) +
  # Añade un gráfico de barras, rellenando las barras con el color #CB0017.
   geom_bar(stat = "identity", aes(fill = Frequency)) +
   scale_y_continuous(labels = scales::percent) +
  # Aplica un tema predeterminado en blanco y negro para la visualización.
  theme_bw() + 
  # Establece los títulos del gráfico, eje x, y eje y.
  labs(title = "Frequencia de tags", 
       x = "Tags",
       y = "Frecuencia ") + 
   scale_fill_gradient("Frecuencia", low = "skyblue", high = "coral2") +
   theme(axis.text.x = element_text(angle = 90, hjust = 1))
```



```{r}
tags_df <- data.frame(tags = unlist(tags_separados))
tags_df |> group_by(tags) |>  summarise(Frequency = n()) |> mutate(Frequency = Frequency/sum(Frequency), tags = reorder(tags, -Frequency)) |> ggplot(aes(x = tags, y = Frequency)) + geom_bar(stat = "identity", aes(fill = Frequency)) + scale_y_continuous(labels = scales::percent) + theme_bw() + labs(title = "Gráfico de barras con frecuencia relativa de diferentes tags", x = "Tags", y = "Frecuencia relativa") + scale_fill_gradient("Frecuencia", low = "skyblue", high = "coral2") + theme(axis.text.x = element_text(angle = 45, hjust = 1))
```



```{r}
tags_df <- data.frame(tags = unlist(tags_separados))

tags_freq <-tags_df %>%
  group_by(tags) %>%
  summarise(Frequency = n()) %>%
  mutate(Frequency = Frequency/ sum(Frequency)) %>%
  slice_max(Frequency, n=25) %>%
  mutate(tags = reorder(tags, -Frequency))

 ggplot(tags_freq, aes(x = tags, y = Frequency)) +
  # Añade un gráfico de barras, rellenando las barras con el color #CB0017.
   geom_bar(stat = "identity", aes(fill = Frequency)) +
   scale_y_continuous(labels = scales::percent) +
  # Aplica un tema predeterminado en blanco y negro para la visualización.
  theme_bw() + 
  # Establece los títulos del gráfico, eje x, y eje y.
  labs(title = "Frequencia de tags", 
       x = "Tags",
       y = "Frecuencia ") + 
   scale_fill_gradient("Frecuencia", low = "skyblue", high = "coral2") +
   theme(axis.text.x = element_text(angle = 90, hjust = 1))
```

```{r}
tags_df <- data.frame(tags = unlist(tags_separados))

tags_freq <-tags_df %>%
  group_by(tags) %>%
  summarise(Frequency = n()) %>%
  mutate(Frequency = Frequency/ sum(Frequency)) %>%
  slice_min(Frequency, n=25) %>%
  mutate(tags = reorder(tags, -Frequency))

 ggplot(tags_freq, aes(x = tags, y = Frequency)) +
  # Añade un gráfico de barras, rellenando las barras con el color #CB0017.
   geom_bar(stat = "identity", aes(fill = Frequency)) +
   scale_y_continuous(labels = scales::percent) +
  # Aplica un tema predeterminado en blanco y negro para la visualización.
  theme_bw() + 
  # Establece los títulos del gráfico, eje x, y eje y.
  labs(title = "Frequencia de tags", 
       x = "Tags",
       y = "Frecuencia ") + 
   scale_fill_gradient("Frecuencia", low = "lightblue", high = "coral2") +
   theme(axis.text.x = element_text(angle = 90, hjust = 1))
```



```{r}
datos |> 
  # Inicia una visualización de ggplot con 'lab' como el dataframe y 'tipo' como variable en el eje x.
  ggplot(aes(x = to_beat_main)) +
  # Añade un gráfico de barras, rellenando las barras con el color #CB0017.
   geom_histogram(fill = "skyblue") +
  # Aplica un tema predeterminado en blanco y negro para la visualización.
  theme_bw() + 
  # Establece los títulos del gráfico, eje x, y eje y.
  labs(title = "Tiempo en completar el juego principal", 
       x = "Tiempo",
       y = "Frecuencia absoluta")
```

```{r}
datos |> 
  # Inicia una visualización de ggplot con 'lab' como el dataframe y 'tipo' como variable en el eje x.
  ggplot(aes(x = to_beat_extra)) +
  # Añade un gráfico de barras, rellenando las barras con el color #CB0017.
   geom_histogram(fill = "skyblue") +
  # Aplica un tema predeterminado en blanco y negro para la visualización.
  theme_bw() + 
  # Establece los títulos del gráfico, eje x, y eje y.
  labs(title = "Tiempo en completar el juego principal y su contenido extra", 
       x = "Tiempo",
       y = "Frecuencia absoluta")
```

```{r}
datos |> 
  # Inicia una visualización de ggplot con 'lab' como el dataframe y 'tipo' como variable en el eje x.
  ggplot(aes(x = to_beat_completionist)) +
  # Añade un gráfico de barras, rellenando las barras con el color #CB0017.
   geom_histogram(fill = "skyblue") +
  # Aplica un tema predeterminado en blanco y negro para la visualización.
  theme_bw() + 
  # Establece los títulos del gráfico, eje x, y eje y.
  labs(title = "Tiempo en completar todo el contenido del juego", 
       x = "Tiempo",
       y = "Frecuencia absoluta")
```

```{r}
datos |> 
  # Inicia una visualización de ggplot con 'lab' como el dataframe y 'tipo' como variable en el eje x.
  ggplot(aes(x = extra_content_length)) +
  # Añade un gráfico de barras, rellenando las barras con el color #CB0017.
   geom_histogram(fill = "skyblue") +
  # Aplica un tema predeterminado en blanco y negro para la visualización.
  theme_bw() + 
  # Establece los títulos del gráfico, eje x, y eje y.
  labs(title = "Duración del contenido extra", 
       x = "Tiempo",
       y = "Frecuencia absoluta")
```



##Datos bivariantes

###Gráfico de barras
Se va a comparar las puntuación de metacríticos oficiales con la de los jugadores, en los 10 primeros juegos de la tabla.


```{r}

# Transformar los datos al formato largo, seleccionar los 10 primeros y ajustar metacritic_rating
datos_long <- datos_filtrados %>%
  slice_head(n = 10) %>%
  mutate(metacritic_rating = metacritic_rating / 10) %>%  # Ajustar la puntuación a sobre 10
  pivot_longer(cols = c(metacritic_rating, reviewer_rating), 
               names_to = "tipo", 
               values_to = "valor") %>%
  
  ###ESTO ES LO QUE HACE QUE SALGAN 8 EN VEZ DE 10
  drop_na()  # Eliminar filas con valores NA en reviewer_rating

# Crear el gráfico de barras
ggplot(datos_long, aes(x = name, y = valor, fill = tipo)) +
  geom_bar(stat = "identity", position = position_dodge()) +
  labs(title = "Comparación de Metacritic y Reviewer Ratings",
       x = "Juegos",
       y = "Puntuaciones",
       fill = "Tipo") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))  # Rotar etiquetas del eje x


```

### Gráfico de tags vs años

A continuación compararemos el año de salida de los juegos con el género de juego más producido cada año.

```{r}
# Paso 1: Separar los tags y mantener el año correspondiente
tags_separados <- datos %>%
  select(year, tags) %>%
  # Separar los tags en múltiples filas usando separate_rows
  separate_rows(tags, sep = "\\|")

# Paso 2: Contar las ocurrencias de cada tag por año
tags_por_año <- tags_separados %>%
  group_by(year, tags) %>%
  summarise(tag_count = n()) %>%
  ungroup()

# Paso 3: Filtrar los tags más frecuentes (opcional, por ejemplo, los 10 más frecuentes en total)
tags_mas_frecuentes <- tags_por_año %>%
  group_by(tags) %>%
  summarise(total_count = sum(tag_count)) %>%
  top_n(10, total_count)

# Paso 4: Filtrar los datos para mostrar solo los tags más frecuentes
tags_por_año_filtrado <- tags_por_año %>%
  filter(tags %in% tags_mas_frecuentes$tags)

# Paso 5: Graficar los tags más usados por año
ggplot(tags_por_año_filtrado, aes(x = year, y = tag_count, fill = tags)) +
  geom_bar(stat = "identity", position = "stack") +
  theme_minimal() +
  labs(title = "Tags más usados por año",
       x = "Año",
       y = "Frecuencia de tags",
       fill = "Tags") +
  theme(axis.text.x = element_text(angle = 90, hjust = 1))
```
A continuación un resumen en tabla de lo q dice el gráfico

```{r}
# Paso 1: Filtrar los datos de los últimos 10 años
ultimo_año <- max(datos$year, na.rm = TRUE)  # Obtener el año más reciente
datos_ultimos_10_años <- datos %>%
  filter(year >= (ultimo_año - 9))  # Filtrar los últimos 10 años

# Paso 2: Separar los tags para cada año dentro de los últimos 10 años
tags_separados_ultimos_10_años <- datos_ultimos_10_años %>%
  select(year, tags) %>%
  separate_rows(tags, sep = "\\|")  # Separar los tags en filas individuales

# Paso 3: Agrupar por año y por tag, y contar la frecuencia de los tags por año
conteo_tags_ultimos_10_años <- tags_separados_ultimos_10_años %>%
  group_by(year, tags) %>%
  summarise(frecuencia = n()) %>%
  arrange(year, desc(frecuencia))  # Ordenar por año y frecuencia descendente

# Paso 4: Seleccionar el tag más usado por cada año en los últimos 10 años
tags_mas_usados_ultimos_10_años <- conteo_tags_ultimos_10_años %>%
  group_by(year) %>%
  slice_max(frecuencia, n = 1)  # Obtener el tag más usado para cada año

# Mostrar los tags más usados por año en los últimos 10 años
print(tags_mas_usados_ultimos_10_años)
```

```{r}
# Paso 1: Separar los tags por cada juego
tags_separados <- datos %>%
  select(year, tags) %>%
  separate_rows(tags, sep = "\\|")  # Separar los tags en filas individuales

# Paso 2: Contar la frecuencia de cada tag por año
conteo_tags <- tags_separados %>%
  group_by(year, tags) %>%
  summarise(frecuencia = n(), .groups = 'drop') %>%
  arrange(year, desc(frecuencia))

# Paso 3: Filtrar el tag más frecuente de cada año
tag_mas_frecuente_por_año <- conteo_tags %>%
  group_by(year) %>%
  slice_max(frecuencia, n = 1)

# Paso 4: Crear la gráfica de dispersión
ggplot(tag_mas_frecuente_por_año, aes(x = year, y = frecuencia, color = tags)) +
  geom_point(size = 5, alpha = 0.7) +  # Puntos de tamaño 5
  theme_minimal() +
  labs(title = "Tag más frecuente por Año",
       x = "Año",
       y = "Frecuencia del Tag más Usado",
       color = "Tag más Usado") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

```

```{r}
# Gráfico de dispersión para comparar metacritic_rating y reviewer_rating
ggplot(datos, aes(x = metacritic_rating, y = reviewer_rating)) +
  geom_point(alpha = 0.5, color = "blue") +  # Puntos de color azul con algo de transparencia
  geom_smooth(method = "lm", color = "red", se = FALSE) +  # Línea de tendencia lineal
  theme_minimal() +
  labs(title = "Comparación entre Metacritic Rating y Reviewer Rating",
       x = "Metacritic Rating (0-100)",
       y = "Reviewer Rating (0-10)") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

```{r}

# Gráfico de dispersión para comparar reviewer_rating y to_beat_main
ggplot(datos, aes(x = to_beat_main, y = reviewer_rating)) +
  geom_point(alpha = 0.5, color = "green") +  # Puntos de color verde con algo de transparencia
  geom_smooth(method = "lm", color = "orange", se = FALSE) +  # Línea de tendencia lineal
  theme_minimal() +
  labs(title = "Comparación entre Reviewer Rating y Tiempo para Completar el Juego Principal",
       x = "Tiempo para Completar el Juego Principal (horas)",
       y = "Reviewer Rating (0-10)") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

```{r}
# Filtrar los datos para mantener solo juegos con un tiempo de completar entre 0 y 100 horas
datos_filtrados <- datos %>%
  filter(to_beat_main >= 0 & to_beat_main <= 100)

# Gráfico de dispersión para comparar reviewer_rating y to_beat_main
ggplot(datos_filtrados, aes(x = to_beat_main, y = reviewer_rating)) +
  geom_point(alpha = 0.5, color = "blue") +  # Puntos de color azul con algo de transparencia
  geom_smooth(method = "lm", color = "red", se = FALSE) +  # Línea de tendencia lineal
  theme_minimal() +
  labs(title = "Comparación entre Reviewer Rating y Tiempo para Completar el Juego Principal (0-100h)",
       x = "Tiempo para Completar el Juego Principal (horas)",
       y = "Reviewer Rating (0-10)") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

```{r}
# Gráfico de dispersión para comparar metacritic_rating y to_beat_main
ggplot(datos, aes(x = to_beat_main, y = metacritic_rating)) +
  geom_point(alpha = 0.5, color = "blue") +  # Puntos de color azul con algo de transparencia
  geom_smooth(method = "lm", color = "red", se = FALSE) +  # Línea de tendencia lineal
  theme_minimal() +
  labs(title = "Comparación entre Metacritic Rating y Tiempo para Completar el Juego Principal",
       x = "Tiempo para Completar el Juego Principal (horas)",
       y = "Metacritic Rating (0-100)") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

```{r}
# Filtrar los datos para mantener solo juegos con un tiempo de completar entre 0 y 100 horas
datos_filtrados <- datos %>%
  filter(to_beat_main >= 0 & to_beat_main <= 100)

# Gráfico de dispersión para comparar metacritic_rating y to_beat_main
ggplot(datos_filtrados, aes(x = to_beat_main, y = metacritic_rating)) +
  geom_point(alpha = 0.5, color = "blue") +  # Puntos de color azul con algo de transparencia
  geom_smooth(method = "lm", color = "red", se = FALSE) +  # Línea de tendencia lineal
  theme_minimal() +
  labs(title = "Comparación entre Metacritic Rating y Tiempo para Completar el Juego Principal (0-100h)",
       x = "Tiempo para Completar el Juego Principal (horas)",
       y = "Metacritic Rating (0-100)") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```